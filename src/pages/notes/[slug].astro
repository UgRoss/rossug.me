---
import type { CollectionEntry } from 'astro:content'

import { render } from 'astro:content'

import Tag from '@/components/ui/Tag.astro'
import PostLayout from '@/layouts/PostLayout.astro'
import { getFilteredNotes } from '@/utils/notes'

type Props = CollectionEntry<'notes'>

export async function getStaticPaths() {
  const notes = await getFilteredNotes()
  return notes.map((note) => ({
    params: { slug: note.id },
    props: note
  }))
}

const note = Astro.props
const { Content } = await render(note)
---

<PostLayout pubDate={note.data.pubDate} title={note.data.title}>
  <div class="mb-4">
    <Tag
      href={`/notes?category=${encodeURIComponent(note.data.category)}`}
      label={note.data.category}
    />
  </div>

  <Content />

  <div class="mt-8 border-t border-neutral-200 pt-6 dark:border-neutral-800">
    <a
      class="inline-flex items-center text-sm text-neutral-600 transition-colors hover:text-neutral-900 dark:text-neutral-400 dark:hover:text-neutral-100"
      href="/notes"
    >
      ‚Üê Back to all notes
    </a>
  </div>
</PostLayout>
